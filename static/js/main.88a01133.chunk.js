(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{420:function(e,t,a){e.exports=a(889)},425:function(e,t,a){},426:function(e,t,a){},806:function(e,t){},808:function(e,t){},847:function(e,t){},889:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(414),o=a.n(c),s=(a(425),a(426),a(9)),i=a(97),l=(a(427),a(14)),u=a(15),d=a(17),m=a(16),h=a(18),p=a(19),f=a.n(p),E=a(22),g=function(){return r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"indeterminate"}))},b=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelectorAll(".sidenav");f.a.Sidenav.init(e)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("nav",{className:"grey darken-2 navbarDiv"},r.a.createElement("div",{className:"nav-wrapper container"},r.a.createElement(s.b,{className:"brand-logo",to:"/"},"\u30c1\u30e3\u30c3\u30c8"),r.a.createElement("a",{href:"#","data-target":"mobile-demo",className:"sidenav-trigger"},r.a.createElement("i",{className:"material-icons"},"menu")),r.a.createElement("ul",{className:"right hide-on-med-and-down"},this.props.auth.uid?r.a.createElement("span",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/createchat"},"Create Chat")),r.a.createElement("li",null,r.a.createElement("a",{onClick:this.props.signOut},"Log out")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/profile"},this.props.profile.nick))):r.a.createElement("span",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/signin"},"Log in")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/signup"},"Sign up")))))),r.a.createElement("ul",{className:"sidenav",id:"mobile-demo"},this.props.auth.uid?r.a.createElement("span",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/createchat",className:"sidenav-close"},"Create Chat")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/",className:"sidenav-close",onClick:this.props.signOut},"Log out")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/profile",className:"sidenav-close"},this.props.profile.nick))):r.a.createElement("span",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/signin",className:"sidenav-close"},"Log in")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/signup",className:"sidenav-close"},"Sign up")))),this.props.loading?r.a.createElement(g,null):null)}}]),t}(n.Component),v=Object(E.b)(function(e){return{auth:e.firebase.auth,profile:e.firebase.profile,loading:e.loading.loading}},function(e){return{signOut:function(){return e(function(e,t,a){(0,a.getFirebase)().auth().signOut().then(function(){e({type:"SIGNOUT_SUCCESS"})})})}}})(b),N=a(64),O=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.onChange=function(e){a.setState(Object(N.a)({},e.target.id,e.target.value))},a.onSubmit=function(e){e.preventDefault(),a.props.signIn(a.state)},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props;if(null!==t.authError&&e.authError!==t.authError){var a="<span>"+t.authError+"</span>";f.a.toast({html:a})}}},{key:"render",value:function(){return this.props.auth.uid?r.a.createElement(i.a,{to:"/"}):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12"},r.a.createElement("h3",null,"Sign In"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"email",type:"email",className:"validate",onChange:this.onChange}),r.a.createElement("label",{htmlFor:"email"},"Email"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"password",type:"password",className:"validate",onChange:this.onChange}),r.a.createElement("label",{htmlFor:"password"},"Password"))),r.a.createElement("button",{className:"btn waves-effect waves-light",type:"submit",name:"action",onClick:this.onSubmit},"Submit",r.a.createElement("i",{className:"material-icons right"},"send")))))}}]),t}(n.Component),y=Object(E.b)(function(e){return{auth:e.firebase.auth,loading:e.loading.loading,authError:e.auth.authError}},function(e){return{signIn:function(t){return e((a=t,function(e,t,n){var r=n.getFirebase;e({type:"LOADING_START"}),r().auth().signInWithEmailAndPassword(a.email,a.password).then(function(){e({type:"LOGIN_SUCCESS"})}).catch(function(t){e({type:"LOGIN_ERROR",err:t})}).then(function(){e({type:"LOADING_END"})})}));var a}}})(O),w=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",nick:"",password:"",confirm:""},a.onChange=function(e){a.setState(Object(N.a)({},e.target.id,e.target.value))},a.onSubmit=function(e){e.preventDefault(),a.state.password===a.state.confirm&&a.props.signUp(a.state)},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props;if(null!==t.authError&&e.authError!==t.authError){var a="<span>"+t.authError+"</span>";f.a.toast({html:a})}}},{key:"render",value:function(){return this.props.auth.uid?r.a.createElement(i.a,{to:"/"}):r.a.createElement("div",{className:"container"},this.props.loading?r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"indeterminate"})):null,r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12"},r.a.createElement("h3",null,"Sign Up"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"email",type:"email",className:"validate",onChange:this.onChange}),r.a.createElement("label",{htmlFor:"email"},"Email"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"nick",type:"text",onChange:this.onChange}),r.a.createElement("label",{htmlFor:"nick"},"Nick"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"password",type:"password",className:"validate",onChange:this.onChange}),r.a.createElement("label",{htmlFor:"password"},"Password"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"confirm",type:"password",onChange:this.onChange}),r.a.createElement("label",{htmlFor:"confirm"},"Password"))),r.a.createElement("button",{className:"btn waves-effect waves-light",type:"submit",name:"action",onClick:this.onSubmit},"Submit",r.a.createElement("i",{className:"material-icons right"},"send")))))}}]),t}(n.Component),S=Object(E.b)(function(e){return console.log("sign up state => ",e),{auth:e.firebase.auth,authError:e.auth.authError,loading:e.auth.loading}},function(e){return{signUp:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase,c=n.getFirestore;t({type:"LOADING_START"});var o=r(),s=c();o.auth().createUserWithEmailAndPassword(e.email,e.password).then(function(t){return s.collection("users").doc(t.user.uid).set({nick:e.nick,friends:[]})}).then(function(){t({type:"SIGNUP_SUCCESS"})}).catch(function(e){t({type:"SIGNUP_ERROR",err:e})}).then(function(){t({type:"LOADING_END"})})}}(t))}}})(w),j=a(29),C=a(23),k=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={chatName:"",members:[]},a.onChange=function(e){a.setState(Object(N.a)({},e.target.id,e.target.value))},a.onSubmit=function(e){e.preventDefault(),new Promise(function(e,t){var n=[a.props.profile.nick];a.instances[0].chipsData.forEach(function(e){"Your friend"!==e.tag&&"Another one"!==e.tag&&n.push(e.tag)}),a.setState({members:n}),e()}).then(function(){if(a.state.password===a.state.confirm)return a.props.createChat(a.state)}).then(function(){if(null==a.props.chatError)a.props.history.push("/");else{var e="<span>"+a.props.chatError+"</span>";f.a.toast({html:e})}})},a.friendsloaded=function(){if(a.instances){var e={};a.props.friendslist&&a.props.friendslist.map(function(t){e[t.nick]=null}),console.log("loaded => ",e),a.instances[0].autocomplete.options.data=e}},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelectorAll(".chips"),t={};this.props.friendslist&&this.props.friendslist.map(function(e){t[e.nick]=null}),this.instances=f.a.Chips.init(e,{data:[{tag:"Your friend"},{tag:"Another one"}],autocompleteOptions:{limit:1/0,minLength:3}})}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this;return null!==this.props.friendslist&&this.friendsloaded(),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12"},r.a.createElement("h3",null,"Create Chat"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"chatName",type:"text",onChange:this.onChange}),r.a.createElement("label",{htmlFor:"chatName"},"Chat Name"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("div",{className:"chips",onChange:function(){e.setState({members:e.instances[0].chipsData})}}))),r.a.createElement("button",{className:"btn waves-effect waves-light",type:"submit",name:"action",onClick:this.onSubmit},"Submit",r.a.createElement("i",{className:"material-icons right"},"send")))))}}]),t}(n.Component),A=Object(C.d)(Object(E.b)(function(e){return console.log("create chat state => ",e),{profile:e.firebase.profile,auth:e.firebase.auth,authError:e.auth.authError,friendslist:e.firestore.ordered.friendslistnew,chatError:e.chat.chatError}},function(e){return{createChat:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase,c=n.getFirestore;console.log(e),r();var o=c(),s=a().firebase.profile;a().firebase.auth.uid,o.collection("chats").add({author:s.nick,name:e.chatName}).then(function(t){return e.members.map(function(a){o.collection("users").where("nick","==",a).get().then(function(n){n.forEach(function(n){o.collection("users").doc(n.id).collection("chats").doc(t.id).set({name:e.chatName}),o.collection("chats").doc(t.id).collection("users").doc(n.id).set({nick:a})})})})}).then(function(){t({type:"CREATE_CHAT",newChat:e})}).catch(function(e){t({type:"CREATE_CHAT_ERROR",err:e})})}}(t))}}}),Object(j.firestoreConnect)(function(e){return[{collection:"users",doc:e.auth.uid?e.auth.uid:"",subcollections:[{collection:"friends"}],storeAs:"friendslistnew"}]}))(k),D=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={nick:""},a.findFriends=function(e){a.props.findFriend(a.nickInput.value);var t={};a.props.matchedFriends&&a.props.matchedFriends.map(function(e){t[e]=null});var n=document.querySelector(".autocomplete");a.autocomplete=f.a.Autocomplete.init(n),a.autocomplete.updateData(t)},a._handleKeyDown=function(e){"Enter"===e.key&&a.onSubmit(e)},a.onSubmit=function(e){a.nickInput.value.length>2&&(a.props.addFriend(a.nickInput.value),a.nickInput.value="")},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props;if(e.addedFriend!=t.addedFriend){var a="<span>"+t.addedFriend+' was added to your friends list!</span><button class="btn-flat toast-action">Undo</button>';f.a.toast({html:a})}if(e.addingError!==t.addingError&&!1!==t.addingError){a="<span>"+t.addingError+"</span>";f.a.toast({html:a})}}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"material-icons prefix addFriendButton",onClick:this.onSubmit},"person_add"),this.state.nick,r.a.createElement("input",{type:"text",id:"autocomplete-input",className:"autocomplete",onChange:this.findFriends,onKeyDown:this._handleKeyDown,ref:function(t){e.nickInput=t},autoComplete:"off"}),r.a.createElement("label",{htmlFor:"autocomplete-input"},"Find friends")))))}}]),t}(n.Component),R=Object(C.d)(Object(E.b)(function(e){return{profile:e.firebase.profile,auth:e.firebase.auth,matchedFriends:e.friends.matchedFriends,addedFriend:e.friends.addedFriend,addingError:e.friends.addingError}},function(e){return{findFriend:function(t){return e(function(e){return function(t,a,n){(0,n.getFirestore)().collection("users").orderBy("nick").startAt(e).endAt(e+"\uf8ff").get().then(function(e){var t=[];return e.forEach(function(e){t.push(e.data().nick)}),Promise.all(t)}).then(function(e){t({type:"FOUND_FRIENDS",nickArr:e})}).catch(function(e){t({type:"FOUND_FRIENDS_ERROR",err:e})})}}(t))},addFriend:function(t){return e(function(e){return function(t,a,n){var r=(0,n.getFirestore)(),c=a().firebase.auth.uid;r.collection("users").where("nick","==",e).get().then(function(t){if(0!=t.empty)throw new Error("User with that nick does not exist!");t.forEach(function(t){return r.collection("users").doc(c).collection("friends").doc(t.id).set({nick:e})})}).then(function(){t({type:"ADDED_FRIEND",nick:e})}).catch(function(e){t({type:"ADDED_FRIEND_ERROR",err:e})})}}(t))}}}),Object(j.firestoreConnect)(function(e){return[]}))(D),_=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement("h3",null,"Friends"),r.a.createElement("ul",{className:"collection",id:"heightForTab"},this.props.friendslist&&this.props.friendslist.map(function(e){return r.a.createElement("li",{className:"collection-item",key:e.id},e.nick)})))))}}]),t}(n.Component),F=Object(C.d)(Object(E.b)(function(e){return{profile:e.firebase.profile,auth:e.firebase.auth,friendslist:e.firestore.ordered.friendslist}},function(e){return{}}),Object(j.firestoreConnect)(function(e){return[{collection:"users",doc:e.auth.uid?e.auth.uid:"",subcollections:[{collection:"friends"}],storeAs:"friendslist"}]}))(_),I=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.props.auth.uid?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"section"},r.a.createElement("h3",null,r.a.createElement(s.b,{to:"/createchat",className:"waves-effect waves-light btn-large"},r.a.createElement("i",{className:"material-icons right"},"add"),"Create Chat"))),r.a.createElement("div",{id:"heightForTab"},this.props.chats&&this.props.chats.map(function(e){return r.a.createElement("div",{className:"row",key:e.id},r.a.createElement("div",{className:"card blue-grey darken-1 z-depth-2"},r.a.createElement("div",{className:"card-content white-text"},r.a.createElement("span",{className:"card-title"},e.name),r.a.createElement("p",null,"Description")),r.a.createElement("div",{className:"card-action"},r.a.createElement(s.b,{to:"/chat/"+e.id},"Start Chatting"))))}))):r.a.createElement(i.a,{to:"/signin"})}}]),t}(n.Component),U=Object(C.d)(Object(E.b)(function(e){return{profile:e.firebase.profile,auth:e.firebase.auth,chats:e.firestore.ordered.chats}},function(e){return{}}),Object(j.firestoreConnect)(function(e){return[{collection:"users",doc:e.auth.uid?e.auth.uid:"",subcollections:[{collection:"chats"}],storeAs:"chats"}]}))(I),T=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={},a.resizeTab=function(){document.querySelector(".tabs-content.carousel")&&(document.querySelector(".tabs-content.carousel").style.height=document.querySelector(".carousel-item.active").querySelector("#heightForTab").scrollHeight+300+"px")},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelector(".tabs");f.a.Tabs.init(e,{swipeable:!0,onShow:this.resizeTab});console.log(window.innerWidth>600)}},{key:"componentDidUpdate",value:function(e){this.resizeTab()}},{key:"render",value:function(){return this.props.auth.uid?r.a.createElement("div",{className:"container"},window.innerWidth<992?r.a.createElement("div",{className:"row section"},r.a.createElement("ul",{className:"tabs"},r.a.createElement("li",{className:"tab col s2"},r.a.createElement("a",{href:"#chatsTab"},"Chats")),r.a.createElement("li",{className:"tab col s2"},r.a.createElement("a",{href:"#friendsTab"},"Friends"))),r.a.createElement("div",null,r.a.createElement("div",{id:"chatsTab"},r.a.createElement(U,null)),r.a.createElement("div",{id:"friendsTab"},r.a.createElement(R,null),r.a.createElement(F,null)))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12 m6 chats"},r.a.createElement(U,null)),r.a.createElement("div",{className:"col s12 m5 offset-m1"},r.a.createElement(R,null),r.a.createElement(F,null)))):r.a.createElement(i.a,{to:"/signin"})}}]),t}(n.Component),x=Object(C.d)(Object(E.b)(function(e){return{profile:e.firebase.profile,auth:e.firebase.auth,chats:e.firestore.ordered.chats}},function(e){return{}}),Object(j.firestoreConnect)(function(e){return[]}))(T),L=a(419),G=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props;if(e.messages!==t.messages){var a=this.props.messages.length-1;a>5&&(a=String(a),this.refs[a].scrollIntoView())}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{ref:"chat",className:"chatContainer col s12 xl8 offset-xl2"},this.props.messages&&Object(L.a)(this.props.messages).reverse().map(function(t,a){return t.author==e.props.chatId?r.a.createElement("div",{key:t.id,className:"messageOuter",ref:a,align:"middle"},r.a.createElement("div",{className:"message grey lighten-5 black-text"},t.content)):t.author!==e.props.user?r.a.createElement("div",{key:t.id,className:"messageOuter",ref:a},r.a.createElement("div",{className:"messageInner"},r.a.createElement("span",{className:"grey-text author"},t.author),r.a.createElement("div",{className:"message grey darken-1 white-text"},t.content))):r.a.createElement("div",{key:t.id,className:"messageOuter",align:"right",ref:a},r.a.createElement("div",{className:"messageInner"},r.a.createElement("div",{className:"message teal lighten-1 white-text"},t.content)))}))}}]),t}(n.Component),M=a(111),P=a.n(M),q=a(182),H=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={sendEos:!1,header:"Options"},a.showSelect=Object(q.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({sendEos:!0,header:"Send Eos"});case 2:e.sent,t=document.querySelector(".friendSelect"),f.a.FormSelect.init(t);case 5:case"end":return e.stop()}},e)})),a.sendEos=function(){""==a.eosAmount.value?f.a.toast({html:"Please enter a valid amount!"}):a.props.sendEos(a.friendSelected[a.friendSelected.selectedIndex].dataset.id,a.eosAmount.value)},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelector(".modal");f.a.Modal.init(e,{onCloseEnd:this.props.close,endingTop:"10%"}).open(),console.log(this.props.users),this.props.reset(),console.log(this.props.user)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{id:"modal1",className:"modal modalOptions"},this.props.loading?r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"indeterminate"})):null,r.a.createElement("div",{className:"modal-content"},r.a.createElement("h4",null,this.state.header),this.state.sendEos?r.a.createElement("div",null,r.a.createElement("h5",null,"to:"),r.a.createElement("select",{className:"friendSelect",ref:function(t){e.friendSelected=t}},r.a.createElement("option",{value:"",disabled:!0,defaultValue:!0},"Who do you want to send money to?"),this.props.users.map(function(t,a){if(t.nick!=e.props.currentUser.nick)return r.a.createElement("option",{value:a,key:a,"data-id":t.id},t.nick)})),r.a.createElement("h5",null,"amount:"),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{id:"eosAmount",type:"number",ref:function(t){e.eosAmount=t}}),r.a.createElement("label",{htmlFor:"eosAmount"},"eos amount")),r.a.createElement("a",{className:"waves-effect waves-light btn",onClick:this.sendEos},"Send")):r.a.createElement("p",null,r.a.createElement("a",{className:"waves-effect waves-teal btn-flat",onClick:this.showSelect},"Send EOS")),null!=this.props.error?r.a.createElement("h6",{className:"center-align section red-text"},this.props.error):null,null!=this.props.completed?r.a.createElement("h6",{className:"center-align section green-text"},this.props.completed):null)))}}]),t}(n.Component),B=a(270),W=a(98),z=a.n(W),K=a(417),J=a.n(K),V=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={chatId:a.props.match.params.id,content:"",options:!1},a.onChange=function(e){a.setState(Object(N.a)({},e.target.id,e.target.value)),a.resizeChat()},a._handleKeyDown=function(e){"Enter"===e.key&&a.onSubmit(e)},a.onSubmit=function(e){e.preventDefault(),a.props.addMessage(a.state),a.setState({content:""}),a.chatMessage.value="",a.resizeChat()},a.showOptions=function(){a.setState({options:!0})},a.resizeChat=function(){var e=document.querySelector(".chat-textarea");e.style.height="",e.style.height=Math.min(e.scrollHeight,70)+"px";var t=document.querySelector(".navbarDiv").offsetHeight,a=document.querySelector(".chat-textarea").offsetHeight,n="calc(98vh - ".concat(t,"px - ").concat(a,"px)");console.log("height",n),document.querySelector(".chat").style.height=n,console.log("navbarHeight",t,"messageInputHeight",a),console.log(document.querySelector(".chat").style)},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelector(".fixed-action-btn");f.a.FloatingActionButton.init(e,{direction:"left"}),this.resizeChat()}},{key:"render",value:function(){var e=this,t=this.props.messages;return r.a.createElement("div",{className:"chat"},r.a.createElement("nav",{className:"nav-extended"},r.a.createElement("div",{className:"nav-content"},r.a.createElement("a",{className:"btn-floating btn-small halfway-fab waves-effect waves-light teal",onClick:this.showOptions},r.a.createElement("i",{className:"material-icons small"},"expand_more")))),this.state.options?r.a.createElement(H,{close:function(){e.setState({options:!1})},users:this.props.users,sendEos:function(t,a){return e.props.sendEos(t,a,e.props.match.params.id)},loading:this.props.loading,error:this.props.blockchain.error,completed:this.props.blockchain.completed,reset:this.props.reset,currentUser:this.props.profile}):null,r.a.createElement("div",{className:"messages"},r.a.createElement(G,{messages:t,user:this.props.profile.nick,chatId:this.props.match.params.id})),r.a.createElement("div",{className:"messageInput"},r.a.createElement("textarea",{ref:function(t){e.chatMessage=t},className:"chat-textarea grey lighten-2 text-black",id:"content",placeholder:"message...",onChange:this.onChange,value:this.state.content,onKeyDown:this._handleKeyDown}),r.a.createElement("div",{className:"messageInput-btnOuter"},r.a.createElement("i",{className:"material-icons small messageInput-btnInner",onClick:this.onSubmit},"send"))))}}]),t}(n.Component),Y=Object(C.d)(Object(E.b)(function(e){return console.log("here => ",e),{profile:e.firebase.profile,auth:e.firebase.auth,messages:e.firestore.ordered.messages,users:e.firestore.ordered.users,blockchain:e.blockchain,loading:e.loading.loading}},function(e){return{addMessage:function(t){return e(function(e){return function(t,a,n){n.getFirebase;var r=(0,n.getFirestore)(),c=a().firebase.profile.nick;console.log("newMessage => ",e),r.collection("chats").doc(e.chatId).collection("messages").add({author:c,content:e.content,createdAt:new Date}).then(function(){t({type:"ADD_MESSAGE"})}).catch(function(e){t({type:"ADD_MESSAGE_ERROR",err:e})})}}(t))},sendEos:function(t,a,n){return e(function(e,t,a){return function(n,r,c){c.getFirebase;var o=c.getFirestore;n({type:"LOADING_START"}),r();var s=o(),i=(r().firebase.profile.nick,"");t=Number(t).toFixed(4),s.get({collection:"users",doc:e}).then(function(e){e.data().hasOwnProperty("eosUsername")?i=e.data().eosUsername:(n({type:"EOS_USERNAME_NOT_FOUND"}),n({type:"LOADING_END"}))}).then(function(){if(""!=i){console.log("to",e,"amount",t,"chatId",a),z.a.plugins(new J.a);var r=z.a.Network.fromJson({blockchain:"eos",chainId:"aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906",host:"https://eos.greymass.com",port:443,protocol:"https"}),c=new B.JsonRpc("https://eos.greymass.com:443");z.a.scatter.connect("Chatto").then(function(){var e=Object(q.a)(P.a.mark(function e(o){var l,u;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=4;break}return n({type:"SCATTER_NOT_OPENED"}),n({type:"LOADING_END"}),e.abrupt("return");case 4:l=z.a.scatter,u={accounts:[r]},l.getIdentity(u).then(function(){var e=l.identity.accounts.find(function(e){return"eos"===e.blockchain}),o=l.eos(r,B.Api,{rpc:c});"".concat(e.name,"@").concat(e.authority),o.transact({actions:[{account:"eosio.token",name:"transfer",authorization:[{actor:e.name,permission:e.authority}],data:{from:e.name,to:i,quantity:t+" EOS",memo:""}}]},{blocksBehind:3,expireSeconds:30}).then(function(e){console.log(e);var t=e.processed.action_traces[0],r=t.act.data,c="Action: "+t.act.name+", from: "+r.from+", quantity: "+r.quantity+", to: "+r.to+", at: "+t.block_time+".";s.collection("chats").doc(a).collection("messages").add({author:a,content:c,createdAt:new Date}).then(function(){n({type:"TRANSACTION_COMPLETE"}),n({type:"LOADING_END"})}).catch(function(e){n({type:"BLOCKCHAIN_ERROR",err:e}),n({type:"LOADING_END"})})}).catch(function(e){e=JSON.stringify(e),n({type:"BLOCKCHAIN_ERROR",error:e}),n({type:"LOADING_END"})})});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}})}}(t,a,n))},reset:function(){return e(function(e){e({type:"BLOCKCHAIN_RESET"})})}}}),Object(j.firestoreConnect)(function(e){return[{collection:"chats",doc:e.match.params.id,storeAs:"chatDetails"},{collection:"chats",doc:e.match.params.id,subcollections:[{collection:"messages"}],limit:30,orderBy:["createdAt","desc"],storeAs:"messages"},{collection:"chats",doc:e.match.params.id,subcollections:[{collection:"users"}],storeAs:"users"}]}))(V),Q=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={},a.showProps=function(){console.log(a.props)},a.setEosUsername=function(){a.props.setEosUsername(a.eosUsername.value),a.eosUsername.value=""},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return this.props.auth.uid?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row section"},r.a.createElement("h5",null,"Eos account name:"),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"material-icons prefix"},"account_circle"),r.a.createElement("input",{ref:function(t){e.eosUsername=t},id:"eosUsername",type:"text",className:"validate",placeholder:this.props.profile.eosUsername}),r.a.createElement("span",{className:"helper-text","data-error":"wrong","data-success":"right"},"Add your Eos username")),r.a.createElement("div",{className:"center-align"},r.a.createElement("button",{className:"btn waves-effect waves-light",type:"submit",name:"action",onClick:this.setEosUsername},"Set",r.a.createElement("i",{className:"material-icons right"},"change_history"))))):r.a.createElement(i.a,{to:"/signin"})}}]),t}(n.Component),X=Object(C.d)(Object(E.b)(function(e){return{profile:e.firebase.profile,auth:e.firebase.auth,userProfile:e.userProfile}},function(e){return{setEosUsername:function(t){return e(function(e){return function(t,a,n){var r=(0,n.getFirestore)(),c=a().firebase.auth.uid;r.collection("users").doc(c).update({eosUsername:e}).then(function(){t({type:"EOS_USERNAME_CHANGED"})}).catch(function(e){t({type:"EOS_USERNAME_ERROR",err:e})})}}(t))}}}),Object(j.firestoreConnect)(function(e){return[]}))(Q);var Z=function(){return r.a.createElement(s.a,{basename:"/chatapp"},r.a.createElement("div",{className:"App"},r.a.createElement(v,null),r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:x}),r.a.createElement(i.b,{path:"/chat/:id",component:Y}),r.a.createElement(i.b,{path:"/signin",component:y}),r.a.createElement(i.b,{path:"/signup",component:S}),r.a.createElement(i.b,{path:"/createchat",component:A}),r.a.createElement(i.b,{path:"/profile",component:X}))))},$=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ee(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var te=a(10),ae={authError:null},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(te.a)({},e,{authError:t.err.message});case"LOGIN_SUCCESS":return console.log("login success"),Object(te.a)({},e,{authError:null});case"SIGNOUT_SUCCESS":return console.log("signout success"),e;case"SIGNUP_SUCCESS":return console.log("signup success"),Object(te.a)({},e,{authError:null});case"SIGNUP_ERROR":return console.log(t.err.message),Object(te.a)({},e,{authError:t.err.message});default:return e}},re=a(138),ce={chatError:null},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_CHAT":return Object(te.a)({},e);case"CREATE_CHAT_ERROR":return console.log("error while creating chat",t.err),Object(te.a)({},e,{chatError:t.err.message});case"ADD_MESSAGE":return console.log("message added"),Object(te.a)({},e);case"ADD_MESSAGE_ERROR":return console.log("error while adding message",t.err),Object(te.a)({},e);default:return e}},se={matchedFriends:null,addedFriend:"",addingError:null},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FOUND_FRIENDS":return console.log("found friends => ",t.nickArr),Object(te.a)({},e,{matchedFriends:t.nickArr});case"FOUND_FRIENDS_ERROR":return console.log("error while searching for friends",t.err),Object(te.a)({},e);case"ADDED_FRIEND":return console.log("friend added => ",t.nick),Object(te.a)({},e,{addingError:null,addedFriend:t.nick});case"ADDED_FRIEND_ERROR":return console.log("error while adding friend",t.err),Object(te.a)({},e,{addingError:t.err});default:return e}},le={loading:!1},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le;switch((arguments.length>1?arguments[1]:void 0).type){case"LOADING_START":return console.log("loading"),Object(te.a)({},e,{loading:!0});case"LOADING_END":return console.log("stopped loading"),Object(te.a)({},e,{loading:!1});default:return e}},de={scatterOpened:null,error:null,completed:null},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SCATTER_NOT_OPENED":return console.log("scatter not opened"),Object(te.a)({},e,{error:"Check your Scatter!"});case"EOS_USERNAME_NOT_FOUND":return Object(te.a)({},e,{error:"User did not connect his eos account with ChatApp!"});case"BLOCKCHAIN_ERROR":return Object(te.a)({},e,{error:t.error});case"TRANSACTION_COMPLETE":return Object(te.a)({},e,{completed:"Transaction completed!"});case"BLOCKCHAIN_RESET":return Object(te.a)({},e);default:return e}},he={usernameError:null},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"EOS_USERNAME_CHANGED":return e;case"EOS_USERNAME_ERROR":return Object(te.a)({},e,{usernameError:t.err});default:return e}},fe=Object(C.c)({auth:ne,chat:oe,friends:ie,firestore:re.firestoreReducer,firebase:j.firebaseReducer,loading:ue,blockchain:me,userProfile:pe}),Ee=a(418),ge=a(271),be=a.n(ge);a(884),a(887);be.a.initializeApp({apiKey:"AIzaSyCUQtaWZu7GmBgX4j1DcFBzCqliCkOE5U0",authDomain:"chatapp-5255c.firebaseapp.com",databaseURL:"https://chatapp-5255c.firebaseio.com",projectId:"chatapp-5255c",storageBucket:"chatapp-5255c.appspot.com",messagingSenderId:"380143631903",appId:"1:380143631903:web:1cb78aa3887e2402"});var ve=be.a,Ne=Object(C.e)(fe,Object(C.d)(Object(C.a)(Ee.a.withExtraArgument({getFirebase:j.getFirebase,getFirestore:re.getFirestore})),Object(re.reduxFirestore)(ve),Object(j.reactReduxFirebase)(ve,{useFirestoreForProfile:!0,userProfile:"users",attachAuthIsReady:!0})));Ne.firebaseAuthIsReady.then(function(){o.a.render(r.a.createElement(E.a,{store:Ne},r.a.createElement(Z,null)),document.getElementById("root"))}),function(e){if("serviceWorker"in navigator){if(new URL("/chatapp",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/chatapp","/sw.js");$?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ee(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ee(t,e)})}}()}},[[420,1,2]]]);
//# sourceMappingURL=main.88a01133.chunk.js.map